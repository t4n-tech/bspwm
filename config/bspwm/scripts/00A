#!/usr/bin/env bash

sleep 0.3

# DBUS
if [ -z "$DBUS_SESSION_BUS_ADDRESS" ]; then
    echo "Not Found D-Bus session, Running dbus-launch..."
    eval "$(dbus-launch --sh-syntax --exit-with-session)"
fi

# Kill old instances
pkill -x dunst
pkill -x polybar
pkill -x sxhkd

while pgrep -u "$UID" -x polybar >/dev/null; do sleep 1; done
while pgrep -u "$UID" -x dunst >/dev/null; do sleep 1; done

# Wallpaper
feh --bg-fill "$HOME/.config/bspwm/wallpaper/Void-1.jpg" &

# Start sxhkd properly
sxhkd &

# Polybar
~/.config/polybar/launch.sh &

# Picom
~/.config/picom/auto.sh &

# Dunst
dunst &

# Polkit
polkit-gnome-authentication-agent-1 &

# Monitor hotplug
~/.config/sxhkd/scripts/monitor &
